<h2>Project: {{ projectId }}</h2>

<h3>Create New Experiment</h3>
<mat-form-field appearance="fill">
  <mat-label>Select Blueprint</mat-label>
  <mat-select [(ngModel)]="selectedBlueprintId" name="blueprintSelect">
    <mat-option *ngFor="let type of experimentTypes" [value]="type.id">
      {{ type.name }}
    </mat-option>
  </mat-select>
</mat-form-field><br>

<button mat-raised-button color="primary" (click)="createExperiment()">+ Create Experiment</button><br><br>

<mat-divider></mat-divider><br><br>
<h2>Experiments</h2>

<div *ngFor="let exp of experiments" class="experiment-card">
  <!-- Header: clickable to expand/collapse -->
  <div class="experiment-header" (click)="exp.expanded = !exp.expanded">
    <span class="title">{{ exp.title }}</span>
    <span class="type">({{ exp.experiment_type_name }})</span>
    <span class="toggle-icon">{{ exp.expanded ? '▲' : '▼' }}</span>
  </div>

 <!-- Expanded content -->
<div class="experiment-details" *ngIf="exp.expanded">
  <div class="details-card">

    <!-- Data Fields Section -->
    <div class="data-fields">
      <div class="data-item" *ngFor="let key of getDataKeys(exp.data)">
        <span class="label">{{ key | titlecase }}</span>
        <span class="value">{{ exp.data[key] }}</span>
      </div>
    </div>

    <hr class="divider">

    <!-- Additional Info Section -->
    <div class="info-section">

      <div class="info-block">
        <div class="info-label">Notes</div>
        <div class="info-value">{{ exp.notes || 'No notes provided' }}</div>
      </div>

      <div class="info-block">
        <div class="info-label">Start Date</div>
        <div class="info-value">
          {{ exp.start_date ? (exp.start_date | date:'mediumDate') : 'Not set' }}
        </div>
      </div>

      <div class="info-block">
        <div class="info-label">End Date</div>
        <div class="info-value">
          {{ exp.end_date ? (exp.end_date | date:'mediumDate') : 'Not set' }}
        </div>
      </div>

      <div class="info-block">
        <div class="info-label">Moving Forward</div>
        <div class="info-value">{{ exp.moving_forward || 'Not specified' }}</div>
      </div>

      <div class="info-block">
        <div class="info-label">Conclusions</div>
        <div class="info-value">{{ exp.conclusions || 'Not specified' }}</div>
      </div>

    </div>
  </div>
</div>


</div>